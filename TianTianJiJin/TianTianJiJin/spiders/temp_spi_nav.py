#-*-coding:utf-8-*-
import requests,pymysql,time
from lxml import etree

mysql_client = pymysql.connect(host='120.55.96.145', port=3306, user='plandev', password='planner1105',database='data_finance', charset='utf8')
# 使用cursor()方法获取操作游标
cur = mysql_client.cursor()
Fund_codes = ['290012', '163117', '001223', '005240', '005239', '003054', '519977', '519976', '003053',
                '160629', '519772', '164818', '005273', '005284', '161127', '121003', '001723', '166019',
                '000969', '002424', '001364', '590008', '161826', '519732', '519698', '000080', '000081',
                '161624', '162703', '161625', '004505', '001266', '001302', '002207', '001323', '001970',
                '000697', '163411', '001951', '001702', '004374', '004375', '001611', '001612', '002692',
                '001215', '002064', '241001', '519773', '001227', '206002', '410003', '519700', '398041',
                '164402', '710301', '162201', '710302', '001438', '165809', '160505', '001437', '160420',
                '121002', '161629', '001838', '160633', '160643', '210002', '163415', '502010', '160419',
                '240022', '004069', '001593', '004070', '000263', '001592', '161027', '502053', '163113',
                '161613', '161720', '003238', '001268', '002656', '501016', '519005', '000893', '005310',
                '004343', '160221', '001985', '003299', '000596', '001298', '110026', '003298', '000690',
                '110025', '002199', '690008', '161217', '160630', '003401', '519097', '160607', '217002',
                '161819', '160223', '165522', '410007', '003765', '003766', '080012', '161628', '340001',
                '160637', '160121', '161022', '502003', '162207', '161024', '001045', '001877', '001409',
                '165520', '000800', '003510', '003511', '519709', '004997', '001616', '040023', '003624',
                '040022', '000297', '163115', '000654', '004752', '350009', '004450', '004753', '003017',
                '001159', '005402', '003704', '003625', '050009', '090017', '002251', '002043', '050019',
                '501019', '050119', '001518', '002379', '002102', '003243', '002101', '003858', '003857',
                '519110', '630011', '160620', '393001', '050024', '004432', '004549', '004433', '001824',
                '530020', '688888', '050001', '210001', '161631', '160125', '531020', '000067', '050201',
                '630008', '001513', '165523', '070011', '002174', '710001', '001719', '481015', '001740',
                '070010', '001092', '000068', '002973', '001679', '519170', '001460', '360012', '004352',
                '519957', '002004', '002079', '163816', '001044', '001319', '160626', '240018', '002003',
                '163817', '004224', '002824', '202005', '161030', '002823', '481008', '360007', '519929',
                '460007', '001125', '070022', '002983', '001759', '003120', '630005', '003119', '360010',
                '100039', '519956', '257060', '690003', '161714', '610006', '090012', '162202', '519712',
                '470059', '001603', '002564', '001629', '164907', '470058', '003623', '001630', '003622',
                '481010', '166301', '000404', '004475', '000924', '002196', '550001', '000513', '070021',
                '000991', '004357', '003956', '090003', '000390', '001361', '005294', '160631', '180020',
                '002256', '003397', '210007', '502036', '004495', '163807', '160519', '002900', '002168',
                '004587', '501015', '050022', '004588', '000751', '001199', '004429', '001978', '004347',
                '700001', '000173', '168203', '001537', '003484', '003485', '001712', '161032', '168204',
                '257040', '002229', '000942', '004694', '160418', '002974', '002192', '001200', '001528',
                '004748', '000136', '001036', '001071', '004597', '519035', '501002', '630002', '161121',
                '004598', '168205', '519191', '004076', '160517', '003175', '161718', '003954', '290005',
                '002863', '165315', '164814', '001170', '519185', '502023', '004394', '001659', '004703',
                '003985', '481017', '002244', '003951', '100020', '000987', '003984', '003950', '161124',
                '040016', '000586', '002669', '000984', '002595', '001822', '165510', '160224', '519704',
                '590002', '630010', '470008', '000928', '002190', '040015', '001713', '001594', '000934',
                '001595', '229002', '550008', '001956', '001156', '000207', '110021', '161029', '450011',
                '003434', '003435', '003232', '000279', '005265', '002620', '005266', '003233', '001830',
                '519026', '580008', '000208', '161723', '470028', '001069', '002252', '110015', '001651',
                '481001', '002683', '519033', '001120', '001954', '470009', '003208', '166006', '320014',
                '001121', '213001', '001975', '163412', '004698', '590001', '160640', '160613', '530003',
                '000870', '002386', '660003', '000619', '164821', '310518', '160422', '003503', '003502',
                '000219', '161715', '001158', '000757', '481004', '450002', '005207', '002861', '202027',
                '217019', '206005', '000793', '000577', '161606', '040018', '161620', '519697', '470888',
                '000003', '161611', '002955', '001543', '519181', '001475', '000004', '020009', '001133',
                '519034', '161025', '002977', '002334', '002335', '420003', '163809', '040190', '040007',
                '519947', '050015', '519091', '160216', '320018', '001154', '000772', '160636', '288002',
                '163402', '660004', '320015', '001252', '003567', '630007', '519157', '630107', '165314',
                '585001', '004359', '000551', '001398', '320006', '160627', '000176', '001471', '163821',
                '004360', '002851', '003147', '540012', '001538', '050013', '004209', '002152', '161213',
                '161210', '001561', '519156', '001560', '162607', '090011', '671010', '070012', '110029',
                '001420', '001554', '002605', '004396', '001421', '002910', '001426', '000971', '519601',
                '001555', '710002', '004287', '003834', '160644', '002123', '005267', '450010', '004423',
                '000803', '001677', '001225', '001626', '161818', '000214', '161031', '202021', '000259',
                '519767', '519196', '004346', '003579', '001487', '550002', '001186', '100038', '003366',
                '483003', '519664', '002305', '519095', '519987', '410001', '519008', '002588', '610002',
                '161038', '004951', '002939', '519692', '001008', '450009', '001701', '160716', '000531',
                '470007', '002315', '005231', '000974', '160610', '002310', '519665', '161810', '167702',
                '005119', '001321', '000432', '460005', '167703', '519995', '160808', '000042', '001254',
                '519089', '001648', '005232', '162107', '270007', '000939', '161028', '001707', '002989',
                '004576', '502026', '070001', '290010', '002715', '519935', '070031', '002340', '519193',
                '003015', '206010', '001476', '004044', '400013', '000039', '001496', '000845', '003550',
                '001043', '001245', '001717', '000993', '162415', '003876', '161816', '004724', '164905',
                '270023', '004725', '260101', '004249', '460220', '001714', '000057', '001208', '000866',
                '090009', '004182', '519694', '070027', '001863', '001188', '001696', '481006', '160137',
                '180018', '000587', '519017', '001017', '000496', '660012', '004468', '070032', '001862',
                '001150', '360005', '004194', '000968', '004195', '002982', '000747', '050020', '002071',
                '519029', '540010', '002189', '001196', '660008', '487021', '360011', '168001', '001272',
                '001219', '000823', '040021', '519918', '165508', '001490', '660005', '580003', '310318',
                '000955', '167601', '519195', '163111', '263001', '001171', '002849', '001607', '002604',
                '457001', '161811', '002808', '001039', '001608', '160417', '590003', '001656', '161207',
                '378006', '000051', '450003', '660015', '100061', '160225', '660001', '210008', '000312',
                '202015', '050116', '001144', '001220', '001628', '000313', '240010', '005209', '090004',
                '481009', '004403', '020011', '519727', '004342', '070019', '005210', '519013', '005009',
                '040002', '165309', '050016', '005036', '160923', '161118', '000913', '001940', '502056',
                '530012', '161903', '519673', '000985', '481013', '005035', '001419', '001273', '000603',
                '000979', '001456', '000961', '630009', '257070', '519678', '620008', '001990', '001708',
                '001294', '003986', '160706', '540006', '000601', '005111', '005000', '110020', '110010',
                '004404', '001618', '001694', '166007', '040011', '001581', '001617', '001637', '001445',
                '000574', '001239', '630109', '050012', '161229', '519116', '005084', '005049', '161724',
                '005050', '004484', '002160', '160615', '161612', '501021', '240004', '460300', '519133',
                '001718', '519967', '519670', '020021', '519965', '519778', '005085', '000613', '169101',
                '004485', '350005', '160807', '580005', '519997', '165515', '004670', '003308', '206012',
                '519032', '090015', '200002', '005062', '213003', '162412', '233010', '001754', '000656',
                '001105', '410008', '162714', '750001', '000717', '001657', '003475', '213010', '005270',
                '270010', '001479', '001104', '080010', '320022', '519651', '004854', '202011', '004855',
                '002987', '002210', '080009', '001291', '040180', '001242', '519690', '290008', '001849',
                '001733', '161211', '501023', '630016', '080005', '002311', '003311', '002316', '000458',
                '001649', '540003', '340008', '519180', '740101', '003865', '470068', '160415', '450008',
                '519115', '630015', '164811', '233015', '001126', '164823', '160212', '004907', '000082',
                '040005', '001056', '050002', '004345', '377016', '100022', '161005', '004112', '001339',
                '004908', '202017', '180033', '217016', '004319', '002449', '550009', '003292', '002731',
                '004318', '370023', '002730', '160922', '004354', '310328', '050004', '519021', '004341',
                '004897', '001424', '160133', '070030', '165521', '001425', '100053', '519100', '166801',
                '002142', '004898', '660010', '160211', '161227', '001236', '110019', '000589', '163808',
                '001588', '001184', '001587', '001244', '004190', '000877', '560003', '004192', '001016',
                '165707', '001586', '004193', '160910', '001589', '162214', '004191', '100026', '519039',
                '001691', '519602', '166802', '165806', '164508', '005037', '161812', '001135', '161721',
                '162907', '000849', '000850', '110027', '000172', '519117', '002594', '001536', '240016',
                '001074', '002098', '004183', '310358', '002097', '004514', '161604', '519677', '162509',
                '003152', '240002', '001015', '163109', '000727', '005038', '410010', '519011', '001924',
                '519018', '240014', '001283', '162307', '160806', '001284', '240001', '000761', '004390',
                '000592', '001281', '002482', '001672', '110028', '001917', '002072', '001573', '519679',
                '003153', '001974', '001459', '002975', '004391', '000127', '202007', '690011', '090016',
                '460009', '001050', '690005', '001119', '001449', '090018', '519015', '162216', '270026',
                '410009', '539002', '001600', '519300', '001599', '530005', '100032', '002236', '001397',
                '160127', '217015', '000628', '660006', '001692', '161225', '290014', '260117', '000311',
                '003416', '002510', '213002', '000698', '000418', '002383', '519975', '002179', '161607',
                '320010', '004000', '004320', '121008', '165511', '004768', '004393', '003548', '519158',
                '210009', '002191', '162213', '240005', '400018', '540002', '004871', '486001', '260104',
                '002180', '002114', '001410', '730001', '502006', '202001', '000073', '003241', '000209',
                '001053', '002115', '003194', '260115', '202002', '003975', '003582', '003974', '161601',
                '001781', '502048', '165512', '470021', '002593', '000965', '003242', '001097', '001540',
                '213008', '233008', '000584', '001809', '002319', '000763', '400011', '002612', '000408',
                '050014', '160611', '610007', '160805', '003378', '001535', '001277', '161610', '002967',
                '003293', '165524', '020015', '000975', '001279', '000368', '160136', '112002', '001076',
                '610005', '000936', '539001', '210004', '000688', '530018', '270025', '001662', '004702',
                '161907', '004434', '004267', '163406', '000411', '000926', '001709', '070017', '001910',
                '004435', '162105', '040036', '002024', '003131', '519983', '398051', '002023', '040037',
                '001798', '001256', '540009', '160638', '673090', '004677', '004212', '001143', '001112',
                '002472', '519003', '000880', '003353', '000967', '370027', '410006', '000165', '260109',
                '502013', '003354', '005063', '002667', '290002', '000056', '165312', '519702', '161123',
                '160322', '100029', '004783', '162208', '005064', '004716', '165310', '110002', '003403',
                '260111', '165528', '167503', '002666', '519027', '000664', '000755', '550003', '001060',
                '110012', '003261', '003262', '002906', '002907', '002485', '080015', '162215', '090010',
                '080007', '003312', '004649', '700002', '217005', '000063', '519706', '163209', '519714',
                '161026', '217021', '001103', '180003', '001577', '002891', '001179', '003957', '002249',
                '530006', '002634', '050007', '003958', '005220', '000478', '183001', '161129', '003658',
                '001763', '002577', '004536', '002694', '001333', '202801', '003598', '000062', '003321',
                '502020', '168201', '000566', '000020', '001054', '399001', '519066', '163409', '161910',
                '004606', '000646', '110022', '000526', '002270', '519961', '519989', '000940', '020003',
                '004489', '162203', '001167', '501020', '001048', '162211', '001869', '003646', '270050',
                '000609', '001665', '003647', '000986', '001673', '001674', '202019', '240019', '001051',
                '160814', '000549', '001664', '620004', '519001', '001469', '290006', '002979', '217009',
                '160311', '233009', '161037', '001681', '375010', '320005', '164809', '000835', '502000',
                '100056', '590006', '001548', '519068', '000547', '160518', '004641', '610004', '001549',
                '160314', '160813', '000409', '001237', '160625', '160516', '001569', '460001', '001643',
                '000536', '217027', '270005', '050021', '005126', '161825', '001301', '519696', '005053',
                '003717', '160616', '162212', '004945', '000689', '001644', '004659', '260116', '001310',
                '001552', '004660', '001553', '001127', '690009', '001614', '001605', '004877', '310398',
                '001663', '519993', '519710', '005075', '260110', '002259', '202009', '001928', '004741',
                '000008', '000663', '377530', '217017', '070023', '202212', '020022', '164906', '000522',
                '001300', '450007', '160119', '002144', '001927', '004868', '001214', '001455', '160916',
                '001500', '501050', '580002', '160603', '000767', '000065', '004348', '320011', '001000',
                '001341', '000527', '000962', '001140', '000120', '003769', '486002', '001725', '370024',
                '002968', '000417', '001808', '002011', '001429', '110009', '004730', '001075', '162413',
                '001113', '001322', '481012', '502040', '360001', '004593', '004344', '163818', '163810',
                '519756', '003940', '001296', '163804', '002425', '001224', '001305', '001030', '460002',
                '003578', '002945', '163803', '004845', '630001', '519069', '000119', '001241', '001695',
                '000433', '002258', '001128', '004250', '000118', '001166', '210006', '004987', '001340',
                '260103', '002952', '005112', '000976', '040035', '003016', '001287', '001312', '005354',
                '161605', '501303', '004846', '660011', '161223', '004785', '202003', '262001', '001392',
                '004065', '002103', '050010', '560002', '519736', '001938', '519688', '162209', '001393',
                '400015', '519113', '162711', '310368', '001218', '620005', '004477', '004244', '002903',
                '004299', '001328', '004300', '001682', '530015', '005144', '001052', '001327', '004996',
                '501018', '001777', '003154', '000021', '000590', '005145', '519672', '000916', '003749',
                '001539', '004310', '001667', '001118', '166402', '519671', '000220', '001778', '001574',
                '000554', '233007', '004476', '004311', '002558', '002562', '519099', '001028', '000328',
                '540008', '260108', '000001', '003629', '502016', '540001', '002028', '001734', '164701',
                '165516', '001735', '000778', '003492', '001852', '398061', '000892', '118002', '005233',
                '501007', '206006', '240009', '001466', '002326', '501008', '398031', '004312', '004313',
                '003132', '180028', '003750', '001416', '398011', '519674', '000828', '002561', '420001',
                '001280', '000535', '004091', '002574', '002307', '004092', '000363', '001270', '460010',
                '690007', '450004', '001040', '202025', '000756', '001433', '001966', '070003', '002303',
                '004958', '001965', '180013', '004857', '162204', '001825', '001271', '000988', '003925',
                '003924', '001362', '004856', '004496', '005495', '003291', '571002', '004497', '004075',
                '001366', '000966', '001379', '161507', '001163', '090006', '519183', '000614', '002651',
                '165313', '002085', '001492', '004308', '002701', '001473', '005496', '002652', '001583',
                '001493', '020023', '620006', '161017', '530009', '180031', '519019', '004309', '000362',
                '005033', '001222', '485111', '001351', '004298', '002559', '762001', '501029', '163116',
                '001467', '002080', '001488', '001983', '002702', '161831', '163801', '001489', '005034',
                '004339', '004338', '160717', '240017', '002167', '004297', '004337', '004336', '002110',
                '090020', '531009', '002693', '002862', '485011', '161719', '002161', '000995', '004304',
                '004303', '070018', '002362', '163407', '000524', '610001', '257050', '160634', '002361',
                '000121', '002159', '001320', '003318', '162605', '673020', '001590', '217020', '580006',
                '001591', '000523', '000978', '002718', '000994', '240011', '004150', '004306', '004305',
                '001541', '310308', '004149', '501001', '350001', '150103', '530019', '161010', '001858',
                '001181', '002767', '005211', '160105', '002654', '080008', '002567', '519120', '398021',
                '164304', '001276', '001263', '001897', '004510', '001967', '002056', '004175', '001064',
                '160215', '770001', '501301', '001373', '002054', '162510', '004176', '206009', '004652',
                '002984', '001359', '000557', '519165', '004142', '002653', '001564', '001654', '519686',
                '004975', '210005', '004135', '530001', '003333', '004008', '000612', '002157', '519025',
                '004143', '217018', '004260', '004965', '002156', '001210', '004263', '550006', '000354',
                '730002', '000480', '004155', '000556', '004009', '001303', '001349', '003555', '004156',
                '160512', '004653', '004966', '004592', '110031', '000867', '001705', '003556', '001267',
                '163805', '020001', '519654', '001072', '001209', '001878', '690006', '001704', '720003',
                '080001', '217008', '582001', '519176', '001736', '000591', '050018', '002323', '001606',
                '582201', '001402', '519642', '700003', '165526', '001482', '000273', '002076', '002602',
                '003501', '001811', '002376', '360006', '210003', '000953', '004944', '003025', '005005',
                '233006', '690206', '003591', '001464', '519087', '270042', '161902', '164819', '217012',
                '213006', '257010', '001758', '590007', '000251', '004948', '001384', '001047', '000471',
                '005006', '003592', '550007', '003413', '001744', '165807', '002177', '004448', '000743',
                '001385', '004272', '001904', '001387', '257020', '000634', '163119', '005076', '004935',
                '180001', '519150', '400007', '000954', '001899', '400022', '005268', '004273', '001396',
                '519125', '580001', '001738', '001892', '005052', '005051', '160514', '001259', '540004',
                '003236', '164510', '001861', '001933', '002193', '164509', '001915', '160138', '000739',
                '004558', '004559', '001450', '001388', '501005', '003237', '100060', '001202', '070020',
                '470098', '160213', '001596', '001998', '160139', '000083', '253010', '163110', '001715',
                '001451', '570005', '004098', '202105', '164205', '002021', '000696', '001823', '000529',
                '001318', '160918', '001903', '001524', '200008', '377020', '485107', '004881', '001331',
                '260112', '690002', '001984', '217010', '001668', '000216', '001014', '161126', '165531',
                '005206', '004189', '160106', '202023', '001332', '002801', '485007', '002853', '000218',
                '001413', '004253', '000217', '161726', '001579', '001414', '690202', '020026', '002611',
                '090013', '002031', '001178', '001417', '002610', '519171', '003715', '001088', '290011',
                '202107', '000236', '001645', '180010', '151001', '070013', '004397', '000960', '004617',
                '000307', '161033', '001722', '162205', '160924', '519606', '001780', '002854', '360016',
                '002963', '240008', '002810', '004993', '002770', '001946', '004157', '003580', '003702',
                '002771', '001563', '040009', '002860', '001945', '501003', '320013', '001389', '450018',
                '000029', '002944', '004994', '040010', '570006', '050123', '270027', '001866', '002919',
                '002263', '164902', '519223', '000958', '000959', '450019', '673030', '110005', '000594',
                '003554', '519224', '450005', '560006', '000410', '450006', '121009', '001198', '004158',
                '003432', '373020', '004205', '050023', '002001', '004139', '160719', '002182', '001635',
                '002121', '519909', '003433', '350002', '002522', '001636', '000545', '080006', '004618',
                '161815', '004518', '000124', '004482', '001453', '001454', '004483', '001845', '128112',
                '720002', '001174', '001474', '121012', '161116', '002147', '161226', '002785', '003970',
                '000834', '001390', '233011', '003971', '001160', '001534', '398001', '001764', '003336',
                '001173', '320001', '040046', '001161', '002233', '000794', '000831', '001623', '001371',
                '005156', '002220', '000963', '003279', '005146', '519733', '160220', '003216', '519093',
                '003215', '000796', '001326', '001325', '519655', '001068', '090007', '519963', '288102',
                '005157', '003437', '005169', '000242', '003436', '001418', '000398', '003282', '100016',
                '004895', '050026', '002521', '519619', '001029', '519162', '519620', '002644', '003283',
                '005170', '162414', '004427', '519163', '001499', '001949', '001604', '001484', '740001',
                '002146', '320004', '001720', '001348', '000017', '370022', '002451', '001948', '160718',
                '040013', '000875', '003642', '003641', '160812', '080002', '002042', '040012', '160628',
                '001185', '501012', '253060', '002450', '501011', '005246', '519979', '000123', '002729',
                '000534', '167001', '002041', '001827', '002728', '002697', '519959', '004519', '519731',
                '253061', '003101', '000822', '002980', '002331', '002547', '001229', '000190', '000122',
                '002802', '070025', '161222', '002089', '255010', '001139', '320017', '519730', '001801',
                '000423', '002164', '002106', '001865', '001864', '004737', '519729', '000708', '519735',
                '000308', '570008', '002020', '040025', '001550', '002563', '001556', '110035', '002885',
                '050111', '110007', '110008', '005039', '001557', '070016', '001551', '395001', '000043',
                '001009', '001297', '000110', '002902', '690001', '070015', '002901', '002978', '530010',
                '519190', '550016', '002513', '003835', '050011', '003632', '000167', '001180', '000532',
                '004747', '000876', '002614', '002615', '003562', '003561', '233001', '380009', '002090',
                '519644', '005040', '004428', '003109', '001685', '240020', '001070', '450001', '004385',
                '519002', '003633', '000011', '003110', '160217', '001337', '004913', '370021', '485114',
                '000567', '004138', '001840', '001841', '519915', '519175', '000294', '001336', '004914',
                '002000', '004222', '002630', '005136', '001795', '151002', '003634', '200001', '002766',
                '003595', '004402', '485014', '003594', '002765', '519197', '550015', '070026', '004995',
                '001816', '510080', '110036', '002165', '001370', '096001', '000150', '004925', '161609',
                '163812', '004154', '002934', '110030', '002639', '004666', '001495', '000149', '004153',
                '004340', '160915', '002597', '000059', '163811', '003690', '372010', '200011', '257030',
                '002935', '519685', '000824', '370026', '000520', '005043', '470078', '003689', '001195',
                '001829', '005244', '370025', '200007', '675111', '000048', '160612', '005342', '519779',
                '162210', '000462', '005044', '000047', '005245', '002621', '675113', '003628', '206008',
                '519683', '162299', '004714', '163302', '050008', '550018', '002554', '040045', '000865',
                '001448', '550019', '001067', '000595', '004351', '000997', '001771', '110018', '004715',
                '004952', '004010', '004712', '110017', '288001', '001880', '004888', '620009', '020002',
                '004713', '160135', '002707', '004953', '004011', '002474', '320012', '002278', '160919',
                '080003', '720001', '003029', '001752', '002566', '121005', '003028', '002194', '002631',
                '001766', '001033', '050025', '002841', '001721', '001517', '002840', '001491', '001313',
                '000309', '118001', '519020', '001004', '000367', '270021', '000948', '166012', '372110',
                '004889', '001891', '163503', '001566', '690004', '001228', '001576', '003180', '160639',
                '004905', '040020', '002186', '400023', '001770', '001765', '000825', '630006', '002599',
                '001265', '003026', '003181', '161219', '000031', '519680', '000667', '470006', '519971',
                '001923', '519172', '003680', '003723', '005106', '165525', '003027', '162719', '002145',
                '000884', '001790', '161115', '166020', '001311', '005221', '002969', '501302', '001874',
                '000652', '000369', '001295', '004243', '161125', '519112', '160219', '001324', '166105',
                '519682', '000071', '320008', '519624', '519623', '005222', '519007', '000511', '001352',
                '470018', '001533', '005237', '350006', '002017', '070005', '004332', '100051', '004829',
                '000684', '519078', '000314', '519111', '005238', '202101', '470011', '001261', '000378',
                '003778', '501031', '001235', '400001', '000377', '002794', '210014', '470010', '163813',
                '673043', '002284', '420102', '217023', '005117', '000998', '002462', '001106', '020012',
                '110003', '002461', '004586', '003234', '501030', '002573', '001979', '519951', '000598',
                '420002', '233012', '001247', '160416', '000270', '003851', '001521', '005217', '003850',
                '161232', '003235', '001367', '005118', '002095', '673081', '161224', '000512', '000109',
                '000386', '001597', '110011', '399011', '000107', '519649', '000070', '004148', '004268',
                '673083', '000457', '003779', '001031', '002018', '002088', '002087', '161727', '002096',
                '000385', '001570', '004683', '001751', '002617', '002565', '002616', '004269', '002421',
                '002405', '002792', '519229', '519228', '290004', '002441', '002112', '320009', '164705',
                '164820', '000672', '002422', '090001', '002007', '501025', '002296', '002793', '001412',
                '000669', '002406', '163819', '000668', '673040', '001316', '001013', '002019', '217013',
                '519173', '165509', '001532', '001011', '001338', '002408', '519667', '000431', '519627',
                '530008', '000617', '320003', '519666', '003842', '121006', '000175', '233013', '340006',
                '400027', '180015', '531008', '000616', '519628', '519198', '001375', '004648', '620007',
                '002598', '539003', '003000', '005121', '000174', '000376', '675081', '400029', '675083',
                '003001', '003295', '519126', '000306', '502030', '002245', '000373', '004361', '003843',
                '519134', '233005', '005279', '001914', '002732', '003670', '161908', '003603', '002246',
                '000572', '001122', '001598', '002382', '002281', '004362', '519127', '590005', '162006',
                '379010', '001123', '164808', '310388', '002381', '001226', '001675', '003604', '002986',
                '000530', '164105', '660009', '164302', '002262', '673110', '001676', '001480', '003191',
                '001947', '002721', '000729', '002717', '003319', '000142', '002058', '519641', '003190',
                '000046', '519640', '002720', '002057', '001711', '360014', '001710', '540005', '001470',
                '020010', '002431', '200012', '002512', '001003', '002723', '000125', '360013', '004014',
                '660109', '002831', '001739', '002743', '003490', '000045', '002742', '003320', '160140',
                '000072', '002208', '003922', '519650', '002105', '002542', '000069', '003170', '217024',
                '004015', '519931', '001087', '003161', '001939', '003923', '003491', '003687', '100018',
                '003686', '000260', '002075', '001086', '002419', '003848', '003167', '000706', '160141',
                '002959', '541005', '002104', '206003', '163114', '002724', '000024', '004902', '002300',
                '002796', '750005', '519030', '002618', '002420', '519132', '160621', '000041', '673100',
                '206004', '003168', '002141', '620003', '002727', '163118', '003849', '164703', '501017',
                '001408', '000131', '002797', '000336', '005028', '001027', '002772', '005192', '001430',
                '001422', '000130', '003897', '001907', '001522', '004521', '163806', '673073', '003967',
                '003966', '005191', '673071', '005218', '270041', '519617', '519616', '001686', '000248',
                '005176', '164908', '004522', '003380', '003379', '001908', '160602', '200006', '002332',
                '519755', '001197', '005219', '161693', '001687', '001330', '003346', '003145', '003345',
                '161603', '001329', '519738', '002416', '002214', '000812', '090002', '519991', '000679',
                '519177', '092002', '002333', '001399', '519050', '000810', '000780', '519613', '210010',
                '020035', '001400', '001190', '002397', '020036', '519981', '519614', '001191', '213007',
                '000950', '002674', '180029', '213917', '000639', '002675', '240012', '003665', '005215',
                '003664', '410004', '000714', '002242', '410005', '001797', '161627', '002261', '002435',
                '161626', '002845', '002434', '210011', '570001', '004571', '002814', '002658', '002049',
                '240013', '002813', '519937', '310379', '002503', '002502', '002413', '002414', '001743',
                '310378', '003104', '002657', '002531', '001706', '519949', '002084', '002430', '002083',
                '001001', '002358', '001282', '002209', '005216', '519625', '000723', '003476', '004572',
                '519657', '163907', '550005', '002601', '000859', '002726', '163823', '002288', '002789',
                '519656', '000025', '550004', '001358', '161505', '519626', '003755', '001558', '003754',
                '001168', '003230', '000466', '003581', '002619', '001582', '002081', '002498', '001005',
                '675013', '000745', '000053', '160635', '000435', '000744', '003596', '519186', '161506',
                '001423', '000854', '003597', '001559', '003710', '003030', '340009', '000143', '001334',
                '004025', '519187', '001183', '395012', '003878', '004292', '519752', '003877', '165517',
                '002124', '001703', '395011', '160608', '002668', '002308', '001335', '040001', '001201',
                '004026', '180026', '002368', '004093', '001275', '003031', '166010', '160218', '040004',
                '000573', '240003', '180025', '519969', '630103', '180030', '001142', '630003', '004777',
                '000481', '000463', '001141', '166004', '161813', '166003', '166011', '003377', '001542',
                '001815', '005370', '004769', '000694', '003376', '003991', '202103', '540007', '002440',
                '003135', '005059', '003409', '202102', '400025', '003992', '261002', '161015', '163208',
                '004517', '003762', '165519', '519933', '004988', '002497', '002966', '530011', '002965',
                '003410', '161128', '003498', '290003', '160622', '206015', '000695', '003763', '002369',
                '000299', '003315', '253030', '000298', '020018', '005290', '270001', '001356', '000711',
                '001794', '420009', '000139', '001355', '001458', '002586', '003395', '004556', '000194',
                '001989', '003668', '002336', '002703', '004555', '002181', '002412', '001988', '002777',
                '000887', '000028', '003993', '004264', '002454', '002739', '003499', '003601', '003602',
                '003231', '002738', '000030', '002745', '002691', '519676', '675100', '000126', '001613',
                '000649', '166008', '001932', '686869', '686868', '519740', '002530', '002363', '002976',
                '002596', '002338', '002585', '161221', '001963', '002922', '002389', '004512', '000052',
                '660002', '161216', '002378', '000050', '000562', '002271', '002317', '004513', '004989',
                '005160', '003089', '005159', '002415', '003669', '003796', '003795', '002775', '000629',
                '000561', '531017', '002066', '660102', '002295', '003852', '001018', '003221', '001148',
                '206018', '519221', '002446', '000937', '675091', '519764', '162108', '002015', '003189',
                '000333', '000179', '001800', '004006', '000355', '004005', '000206', '002640', '100035',
                '675093', '001531', '000185', '530017', '519653', '002360', '001726', '002659', '001021',
                '002660', '040008', '003222', '003090', '000184', '000319', '400003', '675011', '003314',
                '004685', '000804', '003788', '003125', '004119', '003703', '000925', '000181', '020033',
                '000014', '000932', '000320', '002896', '004333', '000474', '002173', '003192', '000508',
                '002535', '003659', '002843', '000973', '002842', '000507', '530021', '020034', '162411',
                '270045', '004168', '004227', '001575', '650001', '004322', '004102', '004103', '166002',
                '675121', '002781', '004807', '002008', '004040', '004118', '110013', '002929', '261102',
                '160123', '371120', '004041', '675123', '650002', '003811', '160124', '371020', '003258',
                '050106', '005262', '004808', '004104', '004105', '004228', '180002', '002534', '000199',
                '000489', '003833', '003545', '003342', '001786', '003812', '001494', '004642', '003730',
                '002909', '003651', '005263', '291007', '519130', '675041', '002143', '290007', '163003',
                '000452', '000490', '003963', '163008', '100037', '519661', '003254', '003643', '003023',
                '003587', '519660', '003100', '003586', '003099', '003102', '003103', '004643', '003255',
                '000215', '675043', '003977', '003976', '003733', '003013', '004136', '675053', '003162',
                '003277', '004614', '004671', '003902', '002137', '003014', '003383', '003382', '004595',
                '675051', '510081', '004086', '004085', '161119', '004206', '000128', '003146', '003866',
                '003358', '003824', '003825', '003607', '003732', '003278', '002442', '003078', '004615',
                '003210', '003265', '004266', '004395', '003361', '003360', '003903', '001792', '003614',
                '004307', '001415', '165705', '673060', '002505', '004560', '485005', '485105', '003667',
                '002504', '003371', '002475', '519745', '519720', '002714', '002579', '519753', '519758',
                '000191', '000840', '004706', '519718', '002519', '001918', '002074', '519220', '002754',
                '004705', '000141', '002438', '002635', '003266', '002807', '002587', '002277', '001520',
                '000839', '002275', '160617', '000186', '002276', '161616', '519746', '004561', '000943',
                '002569', '002578', '519622', '002698', '002590', '002755', '002735', '000890', '002283',
                '002682', '002528', '501103', '261101', '003513', '519726', '002629', '002827', '005011',
                '261001', '001911', '004852', '005010', '003381', '161120', '000889', '161824', '003566',
                '001960', '002447', '003259', '003220', '000286', '001363', '002681', '002568', '001572',
                '002279', '519766', '002337', '519748', '002628', '002544', '002140', '003615', '162511',
                '000564', '519519', '002458', '002776', '003372', '380006', '002364', '002869', '380005',
                '519743', '000305', '002584', '004548', '050027', '002737', '002607', '161614', '100066',
                '002690', '005025', '002453', '002543', '002736', '519723', '166401', '519725', '004126',
                '002466', '519610', '000104', '000630', '002274', '582202', '200016', '002622', '378010',
                '000938', '002456', '582002', '000736', '164403', '001431', '002065', '000153', '000334',
                '002769', '002139', '004825', '000356', '002494', '590010', '040019', '000394', '002927',
                '001023', '000422', '610003', '000152', '002138', '161820', '000205', '001055', '400020',
                '519652', '110038', '270030', '590009', '110037', '519222', '000421', '001501', '001278',
                '002301', '000802', '167501', '000899', '002354', '005054', '003207', '002930', '000058',
                '002198', '519226', '004334', '004246', '270009', '420108', '004247', '000403', '501105',
                '501102', '400009', '003163', '166016', '501101', '003927', '004479', '000801', '003926',
                '485119', '519199', '004108', '487016', '004109', '000933', '002734', '200009', '003188',
                '000016', '420008', '001257', '002529', '070038', '000396', '002227', '070037', '160618',
                '000147', '000182', '003407', '163007', '000473', '519631', '202110', '000420', '000015',
                '001483', '519023', '002228', '270048', '000007', '004456', '000419', '163005', '020028',
                '002536', '519024', '531021', '003816', '003426', '000187', '003425', '002928', '004473',
                '020027', '217003', '000032', '460003', '003260', '003787', '000401', '004107', '004458',
                '003709', '003384', '003708', '004106', '217203', '003096', '003949', '217022', '519669',
                '000400', '004388', '270044', '200113', '460108', '003010', '003869', '003731', '003408',
                '070009', '460008', '040040', '200013', '002648', '002297', '000188', '519153', '001775',
                '020019', '700006', '002624', '519152', '700005', '003287', '003288', '560005', '000023',
                '003268', '003978', '004936', '002265', '004200', '000606', '000022', '004624', '004127',
                '003671', '217011', '040041', '000166', '161122', '206001', '420005', '003169', '519985',
                '519060', '003979', '003226', '003227', '004045', '004608', '004366', '519061', '004367',
                '004853', '003853', '003349', '003009', '003743', '004033', '004220', '164812', '164208',
                '004529', '003130', '003121', '004665', '004601', '004885', '001578', '004609', '003744',
                '003546', '003943', '003944', '004826', '001546', '005243', '003086', '002367', '003084',
                '003081', '003085', '003080', '003083', '519675', '003079', '003182', '400016', '003672',
                '660013', '519188', '004323', '000910', '003082', '002996', '003183', '519189', '003549',
                '002206', '001993', '004937', '005055', '003177', '002932', '001172', '202211', '004528',
                '003176', '005197', '000655', '002933', '519629', '350007', '090019', '750002', '750003',
                '270049', '000192', '270029', '377150', '202108', '320020', '290009', '485019', '100068',
                '000253', '000597', '162712', '000402', '020020', '000737', '040026', '128013', '673010',
                '001571', '000033', '001213', '001212', '164606', '002398', '001791', '121013', '001306',
                '000148', '002282', '673050', '000898', '002719', '002560', '001905', '001922', '002304',
                '519611', '002972', '002399', '000944', '002291', '001875', '001959', '003095', '519051',
                '164401', '001919', '000395', '001258', '002811', '001942', '002387', '164210', '001813',
                '003493', '002798', '001851', '161716', '002433', '610103', '000571', '003284', '000563',
                '002971', '000252', '001779', '206013', '004491', '004490', '001377', '004454', '002073',
                '002589', '004453', '003999', '002970', '002496', '004441', '002489', '001378', '001523',
                '002204', '005269', '164206', '501010', '501009', '002897', '000087', '004110', '005341',
                '400030', '004111', '519634', '003941', '003942', '003218', '000088', '519633', '003219',
                '005198', '004851', '110001', '001250', '000753', '001157', '000754', '002099', '000339',
                '002100', '519056', '000541', '519630', '530016', '001943', '519668', '165532', '002708',
                '573003', '003512', '000977', '001262', '002495', '002197', '001307', '000467', '000479',
                '000351', '000352', '002213', '160624', '002250', '000788', '320007', '163001', '160720',
                '000996', '000061', '121010', '160721', '004763', '004764', '002092', '002093', '001638',
                '000742', '400032', '001986', '206007', '001162', '004726', '004727', '620001', '001502',
                '005161', '000066', '166001', '700004', '100058', '070099', '000878', '160222', '000879',
                '350008', '001221', '001037', '001457', '373010', '002187', '003158', '163822', '110023',
                '000288', '003334', '003335', '001810', '001042', '200010', '162102', '004550', '002780',
                '002148', '000287', '004161', '004164', '166005', '002264', '002272', '001193', '002330',
                '001631', '570007', '000256', '001632', '002125', '002877', '002880', '005142', '180012',
                '005143', '217001', '001565', '004532', '002938', '004315', '004314', '003593', '004533',
                '377240', '160605', '161706', '001061', '001063', '020005', '378546', '001670', '001671',
                '320016', '001955', '000550', '100050', '270002', '001403', '004419', '004420', '004998',
                '005154', '005155', '206011', '005236', '000805', '161725', '005235', '002426', '002429',
                '000746', '002286', '519225', '002443', '001007', '001102', '519908', '001230', '377010',
                '001152', '002391', '002393', '000935', '002400', '002401', '001255', '000290', '000103',
                '001404', '000945', '000946', '519062', '002467', '160632', '004099', '000274', '270028',
                '620002', '121001', '001169', '680001', '001730', '001753', '003463', '003464', '001468',
                '002790', '003745', '001837', '000477', '166009', '001463', '270022', '270006', '000117',
                '001879', '376510', '167301', '200015', '002345', '002465', '270008', '002230', '001192',
                '519161', '519160', '002269', '002215', '003972', '003936', '003653', '003652', '003759',
                '005385', '005047', '005296', '005123', '003758', '003937', '004612', '005360', '004613',
                '005297', '005048']
# Fund_codes.reverse()

# Fund_codes = ['002393'] # 000509
#净值日期</th><th>单位净值</th><th>累计净值</th><th>日增长率</th><th>申购状态</th><th>赎回状态</th><th class='tor last'>分红送配
#净值日期</th><th>每万份收益</th><th>7日年化收益率（%）</th><th>申购状态</th><th>赎回状态</th><th class='tor last'>分红送配
for Fund_code in Fund_codes:
    try:
        history_NAV_url = 'http://fund.eastmoney.com/f10/F10DataApi.aspx?type=lsjz&code={0}&page=1&per=10000&sdate=&edate='.format(Fund_code)
        DEFAULT_REQUEST_HEADERS = {
            "Accept": "*/*",
            "Accept-Encoding": "gzip, deflate, sdch",
            "Accept-Language": "zh-CN,zh;q=0.8",
            "Connection": "keep-alive",
            "Host": "fund.eastmoney.com",
            "Referer": "http://fund.eastmoney.com/data/fundranking.html",
            "User-Agent": "Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/57.0.2987.133 Safari/537.36",
        }

        response0 = requests.get(url=history_NAV_url,headers=DEFAULT_REQUEST_HEADERS).text
        # print(response0)
        response = etree.HTML(response0)

        History_NAV_Date = [i.xpath('.//text()')[0] if i.xpath('.//text()') else ''
                                            for i in response.xpath("//table[@class='w782 comm lsjz']//tr/td[1]")]  # 净值日期
        NAV = [i.xpath('.//text()')[0] if i.xpath('.//text()') else '' for i in
                               response.xpath("//table[@class='w782 comm lsjz']//tr/td[2]")]  # 单位净值
        ANAV = [i.xpath('.//text()')[0] if i.xpath('.//text()') else '' for i in
                                response.xpath("//table[@class='w782 comm lsjz']//tr/td[3]")]  # 累计净值
        Day_change = [i.xpath('.//text()')[0] if i.xpath('.//text()') else '' for i
                                      in response.xpath("//table[@class='w782 comm lsjz']//tr/td[4]")] if response.xpath("//table[@class='w782 comm lsjz']/tbody/tr/td[7]") else ['货币基金' for i in response.xpath("//table[@class='w782 comm lsjz']//tr/td[1]")]  # 收益率
        Purchase_status = [i.xpath('.//text()')[0] if i.xpath('.//text()') else ''
                                           for i in response.xpath("//table[@class='w782 comm lsjz']//tr/td[5]")] if response.xpath("//table[@class='w782 comm lsjz']/tbody/tr/td[7]") else [i.xpath('.//text()')[0] if i.xpath('.//text()') else '' for i in response.xpath("//table[@class='w782 comm lsjz']//tr/td[4]")]  # 申购状态
        Redeem_status = [i.xpath('.//text()')[0] if i.xpath('.//text()') else '' for i in response.xpath("//table[@class='w782 comm lsjz']//tr/td[6]")] if response.xpath("//table[@class='w782 comm lsjz']/tbody/tr/td[7]") else [i.xpath('.//text()')[0] if i.xpath('.//text()') else '' for i in response.xpath("//table[@class='w782 comm lsjz']//tr/td[5]")] # 赎回状态
        Dividends_distribution = [i.xpath('.//text()')[0] if i.xpath('.//text()') else '' for i in response.xpath("//table[@class='w782 comm lsjz']/tbody/tr/td[7]")] if response.xpath("//table[@class='w782 comm lsjz']/tbody/tr/td[7]") else [i.xpath('.//text()')[0] if i.xpath('.//text()') else '' for i in response.xpath("//table[@class='w782 comm lsjz']//tr/td[6]")] # 分红配送
        # print('````````')
        # print(History_NAV_Date)
        # print(NAV)
        # print(ANAV)
        # print(Day_change)
        # print(Purchase_status)
        # print(Redeem_status)
        # print(Dividends_distribution)

        cur.execute("select History_NAV_Date from History_NAV where Fund_code=" + "'" + Fund_code + "'" + ";")
        existed_date =[date[0] for date in cur.fetchall()]
        print(Fund_code,'existed_date:',existed_date)
        for History_NAV_Date, NAV, ANAV, Day_change, Purchase_status, Redeem_status, Dividends_distribution in zip(History_NAV_Date, NAV, ANAV, Day_change, Purchase_status, Redeem_status, Dividends_distribution):
            # if not cur.execute("select * from History_NAV where Fund_code=" + "'" + Fund_code + "'" + " and History_NAV_Date=" + "'" + History_NAV_Date + "'" + ";"):
            #     cur.execute("insert into History_NAV(Fund_code,History_NAV_Date,NAV,ANAV,Day_change,Purchase_status,Redeem_status,Dividends_distribution) VALUES(%s,%s,%s,%s,%s,%s,%s,%s)",
            #         (Fund_code, History_NAV_Date, NAV, ANAV, Day_change, Purchase_status, Redeem_status,
            #          Dividends_distribution))
            #     print('inserting data to mysql...',Fund_code, History_NAV_Date, NAV, ANAV, Day_change, Purchase_status, Redeem_status,Dividends_distribution)
            # else:
            #     print('existed!skiping...')
            #     break
            if History_NAV_Date not in existed_date:
                cur.execute(
                    "insert into History_NAV(Fund_code,History_NAV_Date,NAV,ANAV,Day_change,Purchase_status,Redeem_status,Dividends_distribution) VALUES(%s,%s,%s,%s,%s,%s,%s,%s)",
                    (Fund_code, History_NAV_Date, NAV, ANAV, Day_change, Purchase_status, Redeem_status,
                     Dividends_distribution))
                print('inserting data to mysql...', Fund_code, History_NAV_Date, NAV, ANAV, Day_change, Purchase_status,
                      Redeem_status, Dividends_distribution)
            else:
                print('existed!skiping...')

        mysql_client.commit()
        time.sleep(5)
    except pymysql.Error as e:
        print('error!',e)
        time.sleep(30)

print('正在排序数据表中的id列....')
tableNameList = ["History_NAV"]
for tableName in tableNameList:
    cur.execute("ALTER TABLE " + tableName + " DROP id;")
    cur.execute("ALTER  TABLE " + tableName + " ADD id MEDIUMINT( 8 ) NOT NULL  FIRST;")
    cur.execute("ALTER  TABLE " + tableName + " MODIFY COLUMN id MEDIUMINT( 8 ) NOT NULL  AUTO_INCREMENT,ADD PRIMARY  KEY(id);")
cur.close()
mysql_client.close()
print('Spider finish！',time.strftime('%Y-%m-%d %H:%M:%S',time.localtime(time.time())))

