<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>
        <title>Policy Details System Search Results</title>
       <link rel="stylesheet" href="/hansard/laf/resources/styles/reset.css" type="text/css" media="all" />
        <link rel="stylesheet" href="/hansard/laf/resources/styles/style.css" type="text/css" media="all" />
        <link rel="stylesheet" href="/hansard/laf/resources/styles/print.css" type="text/css" media="print" />
        <script type="text/javascript" src="/hansard/js/util.js"></script>

                <script type="text/javascript" src="/hansard/laf/resources/scripts/jquery-1.4.2.min.js"></script>
        <script type="text/javascript" src="/hansard/laf/resources/scripts/jquery.uniform.js"></script>
        <script type="text/javascript" src="/hansard/laf/resources/scripts/jquery.tools.min.js"></script>
        <script type="text/javascript" src="SearchWindowUtils.js"></script>

        <script type="text/javascript">


             var filterCount;
            function reportChanged()
            {
                myForm = parent.frames[1].document.main;
                report = document.top.report.selectedIndex;
               filterCount=0;

                for( i=1 ; i&lt; parent.frames[1].availableArray.length; i++)
                {
                    //alert(parent.frames[1].availableArray[i].charAt(report-1));

                    if( parent.frames[1].availableArray[i].charAt(report-1) == 1)
                    {
                        var isEvenRow = false;
                       if(filterCount % 2==0){
                           isEvenRow=true;
                        }

                        parent.frames[1].hideQuick(i);
                        parent.frames[1].showRow(i, isEvenRow);
                        filterCount++;

                         eval("myForm.avail"+i+".checked=true;");
                    }
                else
                    {

                       parent.frames[1].hideQuick(i);
                        eval("myForm.avail"+i+".checked=false;");

                    }
                }

                parent.frames[1].setFilterInfo(filterCount);
            }

            function runReport(polIndex)
            {
                policyNo = parent.frames[1].polNumArray[polIndex];
                checkDigit = parent.frames[1].checkDigitArray[polIndex];

                reportName = getSelectValue(parent.frames[0].document.top.report);
                reportText = getSelectText(parent.frames[0].document.top.report);

                var locale = '';

                if( document.top.LocaleField.value == 'select' )
                {
                    locale = getSelectValue(parent.frames[0].document.top.Locale);
                }
                else
                {
                    locale = document.top.Locale.value;
                }

                type="HTML";

                if( parent.frames[1].document.main.PdfAllowed.value == 'true')
                {
                    type = "PDF";

                    if( parent.frames[1].document.top.DocType[0].checked == true )
                    {
                        type="HTML";
                    }
                }

                if( parent.frames[0].document.top.report.selectedIndex == -1 )
                {
                    alert("You have not selected a report to be run.");
                }
                else
                {
                    if( parent.frames[1].availableArray[polIndex].charAt(report-1) == 1)
                    {

                        var policyNumber	= parent.Display.polNumArray[polIndex];
                        var CheckDigit = parent.Display.checkDigitArray[polIndex];
                        var Units = parent.Display.availableArray[polIndex];
                        var company = parent.Display.companyArray[polIndex];


                        if(reportName == 'MarketExposure'
                            &amp;&amp; (Units).search('!')&gt;-1
                            &amp;&amp; parent.Variable_Buffer.reportType != 'PolicyInfo')
                        {
                            alert('This information is only available for policies invested in Hansard Managed Funds only');
                        }
                        else
                        {
                            var winName = getWindowName(reportName, company, policyNumber);

                            parent.frames[0].document.generateReport.target = winName;

                            var wind2 = createWindow(winName, 20, 20, 100, 480);

                            wind2.focus();

                            var today = new Date ( ) ;
                            var rand  = today.getMilliseconds() ;

                            if(reportName == 'Booklet')
                            {
                                parent.frames[0].document.generateReport.Report.value='PolicyBooklet';
                                parent.frames[0].document.generateReport.policyNumber.value=policyNumber;
                                parent.frames[0].document.generateReport.checkDigit.value = CheckDigit;
                                parent.frames[0].document.generateReport.company.value = company;
                                parent.frames[0].document.generateReport.Locale.value= locale;

                                parent.frames[0].document.generateReport.submit();
                            }
                            else
                            {
                                parent.frames[0].document.generateReport.Report.value=reportName;
                                parent.frames[0].document.generateReport.policyNumber.value=policyNumber;
                                parent.frames[0].document.generateReport.checkDigit.value = CheckDigit;
                                parent.frames[0].document.generateReport.company.value = company;
                                parent.frames[0].document.generateReport.Locale.value= locale;
                                parent.frames[0].document.generateReport.type.value= type;

                                parent.frames[0].document.generateReport.submit();
                            }
                        }
                    }
                    else
                    {
                        alert("The report '" + reportText + "' is not Available for Policy " + policyNo + checkDigit);
                    }
                }
            }

function getSelectValueAt(select, index)
{
	return select.options[index].value;
}

function getSelectTextAt(select, index)
{
	return select.options[index].text;
}

            function runSpecifiedReportFor(chosenReport,polIndex)
            {
                var header = parent.frames[0].document;
                var results= parent.frames[1].document;
                policyNo = parent.frames[1].polNumArray[polIndex];
                checkDigit = parent.frames[1].checkDigitArray[polIndex];

                reportName = getSelectValueAt(header.top.report, chosenReport+1);
                reportText = getSelectTextAt(header.top.report,chosenReport+1);

                var locale = '';

                if( document.top.LocaleField.value == 'select' )
                {
                    locale = $('#localeSelect',parent.frames[1].document).attr('value');
                }
                else
                {
                    locale = $('#localeDest input[name=Locale]', results).attr('value');
                }

                type="HTML";

                if( $('#PdfAllowed',results).attr('value') == 'true')
                {
                    type = "PDF";

                    if( parent.frames[1].document.top.DocType[0].checked == true )
                    {
                        type="HTML";
                    }
                }

                if( chosenReport == -1 )
                {
                    alert("You have not selected a report to be run.");
                }
                else
                {
                    if( parent.frames[1].availableArray[polIndex].charAt(chosenReport) == 1)
                    {

                        var policyNumber	= parent.Display.polNumArray[polIndex];
                        var CheckDigit = parent.Display.checkDigitArray[polIndex];
                        var Units = parent.Display.availableArray[polIndex];
                        var company = parent.Display.companyArray[polIndex];


                        if(reportName == 'MarketExposure'
                            &amp;&amp; (Units).search('!')&gt;-1
                            &amp;&amp; parent.Variable_Buffer.reportType != 'PolicyInfo')
                        {
                            alert('This information is only available for policies invested in Hansard Managed Funds only');
                        }
                        else
                        {
                            var winName = getWindowName(reportName, company, policyNumber) ;

                            parent.frames[0].document.generateReport.target = winName;

                            var wind2 = createWindow(winName);

                            wind2.focus();

                            var today = new Date ( ) ;
                            var rand  = today.getMilliseconds() ;

                            if(reportName == 'Booklet')
                            {
                                parent.frames[0].document.generateReport.Report.value='PolicyBooklet';
                                parent.frames[0].document.generateReport.policyNumber.value=policyNumber;
                                parent.frames[0].document.generateReport.checkDigit.value = CheckDigit;
                                parent.frames[0].document.generateReport.company.value = company;
                                parent.frames[0].document.generateReport.Locale.value= locale;

                                parent.frames[0].document.generateReport.submit();
                            }
                            else
                            {
                                parent.frames[0].document.generateReport.Report.value=reportName;
                                parent.frames[0].document.generateReport.policyNumber.value=policyNumber;
                                parent.frames[0].document.generateReport.checkDigit.value = CheckDigit;
                                parent.frames[0].document.generateReport.company.value = company;
                                parent.frames[0].document.generateReport.Locale.value= locale;
                                parent.frames[0].document.generateReport.type.value= type;

                                parent.frames[0].document.generateReport.submit();
                            }
                        }
                    }
                    else
                    {
                        alert("The report '" + reportText + "' is not Available for Policy " + policyNo + checkDigit);
                    }
                }
            }

            function runTopupOnlineFor(policyNo, checkDigit, company)
            {
                var header = parent.frames[0].document;
                var results= parent.frames[1].document;
                reportName = "TopupOnline";
                reportText = "TopupOnline";
                type="HTML";

                var locale = '';

                if( document.top.LocaleField.value == 'select' )
                {
                    locale = $('#localeSelect',parent.frames[1].document).attr('value');
                }
                else
                {
                    locale = $('#localeDest input[name=Locale]', results).attr('value');
                }

                var winName = getWindowName(reportName, company, policyNo);

                parent.frames[0].document.generateReport.target = winName;

                var wind2 = createWindow(winName,20,20,1000,600);

                wind2.focus();

                var today = new Date ( ) ;
                var rand  = today.getMilliseconds() ;
                parent.frames[0].document.generateReport.Report.value=reportName;
                parent.frames[0].document.generateReport.policyNumber.value=policyNo;
                parent.frames[0].document.generateReport.checkDigit.value = checkDigit;
                parent.frames[0].document.generateReport.company.value = company;
                parent.frames[0].document.generateReport.Locale.value= locale;
                parent.frames[0].document.generateReport.type.value= type;

                parent.frames[0].document.generateReport.submit();
            }

            function runTimelineFor(policyNo, checkDigit, company)
            {
                var header = parent.frames[0].document;
                var results= parent.frames[1].document;
                reportName = "Timeline";
                reportText = "Timeline";
                type="HTML";

                var locale = '';

                if( document.top.LocaleField.value == 'select' )
                {
                    locale = $('#localeSelect',parent.frames[1].document).attr('value');
                }
                else
                {
                    locale = $('#localeDest input[name=Locale]', results).attr('value');
                }

                var winName = getWindowName(reportName, company, policyNo);

                parent.frames[0].document.generateReport.target = winName;

                var wind2 = createWindow(winName, 20, 20, 100, 600);

                wind2.focus();

                var today = new Date ( ) ;
                var rand  = today.getMilliseconds() ;
                parent.frames[0].document.generateReport.Report.value=reportName;
                parent.frames[0].document.generateReport.policyNumber.value=policyNo;
                parent.frames[0].document.generateReport.checkDigit.value = checkDigit;
                parent.frames[0].document.generateReport.company.value = company;
                parent.frames[0].document.generateReport.Locale.value= locale;
                parent.frames[0].document.generateReport.type.value= type;

                parent.frames[0].document.generateReport.submit();
            }

            function runTermsAndConditionsFor(policyNo, checkDigit, company)
            {
                var header = parent.frames[0].document;
                var results= parent.frames[1].document;
                reportName = "clientTAC";
                reportText = "Terms and Conditions";
                type="PDF";

                var locale = '';

                if( document.top.LocaleField.value == 'select' )
                {
                	locale = $('#localeSelect', results).attr('value');
                }
                else
                {
                    locale = $('#localeDest input[name=Locale]', results).attr('value');
                }

                var winName = reportName +'_For_' + policyNo ;

                parent.frames[0].document.generateReport.target = winName;

                var wind2 = window.open('', winName,'scrollbars=yes,location=no,toolbar=yes,status=yes,screenx=20,screeny=20,width=1000,height=600,resizable=yes');

                wind2.focus();

                var today = new Date ( ) ;
                var rand  = today.getMilliseconds() ;
                parent.frames[0].document.generateReport.Report.value=reportName;
                parent.frames[0].document.generateReport.policyNumber.value=policyNo;
                parent.frames[0].document.generateReport.checkDigit.value = checkDigit;
                parent.frames[0].document.generateReport.company.value = company;
                parent.frames[0].document.generateReport.Locale.value= locale;
                parent.frames[0].document.generateReport.type.value= type;

                parent.frames[0].document.generateReport.submit();
            }


            function runBatchUp()
            {
                var numberOfBatchSelected = parent.frames[1].numberOfBatchSelected();

                var locale = '';

                if( document.top.LocaleField.value == 'select' )
                {
                    locale = getSelectValue(parent.frames[0].document.top.Locale);
                }
                else
                {
                    locale = document.top.Locale.value;
                }

                if( numberOfBatchSelected == 0 )
                {
                    alert("You must select at least one Policy in order to run a batch of reports.");
                }
                else
                {
                    wind2 = window.open('', 'PdsBatch','scrollbars=yes,location=no,toolbar=yes,status=yes,screenx=20,screeny=20,resizable=yes');

                    if( document.top.LocaleField.value == 'select' )
                    {
                        locale = getSelectValue(parent.frames[0].document.top.Locale);
                    }
                    else
                    {
                        locale = document.top.Locale.value;
                    }

                    parent.frames[1].document.main.Locale.value = locale;
                    parent.frames[1].document.main.submit();
                    wind2.focus();
                }
            }

            function saveDefault()
            {
                document.SetLocale.Locale.value = $('#localeSelect',parent.frames[1].document).attr('value');

                document.SetLocale.submit();
            }



            function loading()
            {



                parent.frames[1].document.write('&lt;HTML&gt;');
                parent.frames[1].document.write('&lt;BODY BGCOLOR=white TEXT=darkblue &gt;');
                parent.frames[1].document.write('&lt;CENTER&gt;&lt;P STYLE="font-size:medium; "&gt;');
                parent.frames[1].document.write('&lt;P STYLE="font-size:medium; "&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;div id="imgholder" style="text-align:center"/&gt;&lt;img src="/hansard/laf/resources/images/facebox/loading.gif"/&gt;&lt;br/&gt;');
                parent.frames[1].document.write('&lt;span style="font-family: arial, helvetica, lucida grande, tahoma, verdana, arial, sans-serif;font-size:20px;color:gray"&gt;Searching, please wait&lt;/span&gt; ');
                parent.frames[1].document.write('&lt;/P&gt;');
                parent.frames[1].document.write('&lt;/CENTER&gt;');
                parent.frames[1].document.write('&lt;/BODY&gt;');
                parent.frames[1].document.write('&lt;/HTML&gt;');
                parent.frames[1].document.close();

                //parent.Display.document.location.assign('/hansard/hansard/servlet/pds/Pds?RequestedPage=SearchResults');
                document.results.submit();


            }
        </script>

                <script>

                    var reportNameArray=new Array();
                    var reportIDArray= new Array();
                    $(document).ready(function(){
                    var reportsSelect = $('#reportsAvail');

                    $('#reportsAvail option').each(function(){
                        reportNameArray.push($.trim($(this).html()));
                        reportIDArray.push($(this).attr('value'));
                    });
                    $('#reportNames').val(reportNameArray);
                    $('#reportIds').val(reportIDArray);

                    });
                 </script>
        <style type="text/css">
            input {font-size:x-small;}
            h1    {font-family:times;}
        </style>
    </head>

    <body onload="loading();" onresize="" marginwidth="0" marginheight="0">
<div id="broker_branding_wrap">
		<div id="broker_branding">
			<!-- USE THUMBNAIL IF NEEDED <img src="" alt="Corporate Logo" /> -->
			<h1>
				Default Branding
			</h1>
		</div>

	</div>
        <div class="container" style="padding-right:17px">
			<h2>Policy Details System</h2>
			<ul id="local_nav" style="padding-right:17px">

				<li>
					<a href="Pds?RequestedPage=AdvancedSearch" target="_top">Advanced Search</a>
				</li>
				<li>
					<a href="Pds?RequestedPage=BasicSearch" target="_top">Basic Search</a>
				</li>
			</ul>
		</div>
        <div class="container" style="padding-right:17px">
            <form name="top" method="post">
                <div class="panel clearfix">
                    <div class="full">
                        <div class="col_type_3">


                            <fieldset>
                                <div class="col">
                                    <label>
                                        Select Report
                                    </label>
                                    <select id="reportsAvail" name="report" onchange="reportChanged()">
                                        <option value="NONE">No Report Selected</option>
                                        <option value="Booklet">Policy Booklet
</option><option value="PolicyInformation">Key Policy Information
</option><option value="UnitAllocation">Unit Allocation Statement
</option><option value="HistoricUAS">Historic UAS
</option><option value="DetailedUAS">Detailed Transaction Statement
</option><option value="FundPerformanceGraph">Unit Fund Link Performance Graph
</option><option value="FundPerformanceTable">Unit Fund Link Performance Table
</option><option value="PolicyValueGraph">Policy Value Graph
</option><option value="FundValueGraph">Unit Fund Link Value Graph
</option><option value="PremiumHistory">Premium History
</option><option value="DetailedPremiumHistory">Detailed Premium History
</option><option value="FundSwitchHistory">Unit Fund Link Switch History
</option><option value="PPPolicyInformation">PP Policy Information
</option><option value="PPCashStatement">PP Cash Statement
</option><option value="PPAssetStatement">PP Asset Statement
</option><option value="PPValuation">PP Valuation
</option><option value="PPHistoricValuation">PP Historic Valuation
</option><option value="ScannedDocuments">Scanned Documents
</option></select>
                                    <input type="text" id="reportNames" />
                                    <input type="text" id="reportIds" />
                                </div>
                                <div class="col">

                                    <div class="radio_group">
<label>Report Format</label>
                                        <input type="radio" checked="checked" name="DocType" value="HTML" />
                                        <label>HTML</label>
                                                                            <input type="radio" name="DocType" value="PDF" />
<label>PDF</label>

                                        </div>
                                </div>
                                <div class="col" id="localeList">

                                    <div style="float:left;">
                                        <label>Language</label>
                                         <button id="localeSave" class="submit" type="button" value="Default">Save</button>
                                        <select id="localeSelect" name="Locale" style="float:none;" onchange="languageChange();parent.frames[1].updateBatchLocale(this);">
                                                <option value="GB,en" selected="">English (default)
</option><option value="NL,nl">Dutch
</option><option value="FR,fr">French
</option><option value="DE,de">German
</option><option value="IT,it">Italian
</option><option value="NO,no">Norwegian
</option><option value="ES,es">Spanish
</option><option value="SE,sv">Swedish
</option><option value="PT,pt">Portuguese
</option><option value="TW,zh">Chinese
</option><option value="JP,ja">Japanese
</option></select>


                                 </div>
                                <input type="hidden" name="LocaleField" value="select" />
                                </div>

                            <input type="hidden" name="Screen" value="report" />
                            <input type="hidden" name="PolicyNumber" />
                            <input type="hidden" name="PolicyCheckDigit" />
                            <input type="hidden" name="Language" value="english" />
                            <input type="hidden" name="policy" value="6" />

                        </fieldset>

                    </div>
                </div>
            </div>
        </form>
        <form name="generateReport" method="post" enctype="UTF-8" accept-charset="UTF-8">
            <input type="hidden" name="Report" />
            <input type="hidden" name="policyNumber" />
            <input type="hidden" name="checkDigit" />
            <input type="hidden" name="company" />
            <input type="hidden" name="Locale" />
            <input type="hidden" name="type" />
        </form>

        <form name="SetLocale" action="Pds" method="post">
            <input type="hidden" name="RequestedPage" value="SearchResultsHeader" />
            <input type="hidden" name="Action" value="ChangeDefaultLocale" />
            <input type="hidden" name="Locale" />
        </form>

        <form name="results" action="Pds" target="Display" method="post">
        <input type="hidden" name="RequestedPage" value="SearchResults" />
        </form>


    </div>


</body></html>